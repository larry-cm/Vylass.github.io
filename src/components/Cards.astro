---
import Image from "astro/components/Image.astro";

interface Props {
    id: string;
    imageUser: string;
    firstName: string;
    title: string;
    description: string;
    inscripcionDate: string;
    imagePost: string;
    index: number;
}
const {
    index,
    imageUser,
    id,
    inscripcionDate,
    firstName,
    title,
    description,
    imagePost,
} = Astro.props;
// const x = sessionStorage.getItem("jsj");
const lazyAceppt = index < 3 ? "eager" : "lazy";
const slug = `${firstName.toLowerCase().replace(" ", "").split(" ").join("-")}-${id.slice(-5)}`;
const badge = index < 4;
const segureDescription = description.slice(0, 50);
const delay = index !== 0 ? `${index + 1}00ms` : "0s";
const language = Astro.locals.lang;
---

<style define:vars={{ delay }}>
    .slide-in-top {
        animation: slide 0.5s ease-out forwards;
        animation-delay: var(--delay);
        transform: translateY(20px);
        opacity: 0;
    }
    @keyframes slide {
        0% {
        }
        100% {
            transform: translateY(0px);
            opacity: 1;
        }
    }
</style>

<script>
    function applySlide() {
        if (!sessionStorage.getItem("animado")) {
            sessionStorage.setItem("animado", "true");
            document
                .querySelectorAll("[data-anima]")
                .forEach((element) => element.classList.add("slide-in-top"));
        }
    }

    window.addEventListener("DOMContentLoaded", applySlide);
    document.addEventListener("astro:page-load", applySlide);
</script>

<article class="w-full h-[35rem] sm:h-[33rem] snap-center">
    <a
        href={slug}
        class="flex flex-col rounded-md shadow-sm size-full bg-fondo"
    >
        <picture
            class="relative w-auto max-w-full m-4 text-white rounded h-70 min-h-70"
        >
            {
                badge && (
                    <p
                        style={{ bottom: ".5rem", left: ".5rem" }}
                        class="absolute rounded bg-secondary/80 backdrop-blur-md py-0.5 px-1.5 border border-transparent text-xs text-white transition-all shadow-xs w-20 text-center capitalize"
                    >
                        Reciente
                    </p>
                )
            }

            <Image
                height={100}
                width={100}
                role="img"
                loading={lazyAceppt}
                class="object-cover rounded size-full"
                src={imagePost || import.meta.env.SECRET_IMG_DEFAULT}
                alt="card-image"
            />
        </picture>

        <div class="flex flex-col justify-between size-full">
            <div class="p-4 pt-0 mask-b-from-70% mask-b-to-90%">
                <h3
                    class="mb-[1lh] text-xl text-wrap text-break wrap-break-word overflow-hidden text-ellipsis font-semibold text-slate-100"
                >
                    {title || "Website Review Check"}
                </h3>
                <p
                    class="font-light leading-normal text-slate-300 text-wrap text-ellipsis text-break wrap-break-word relative after:absolute after:content-['...']"
                >
                    {
                        segureDescription ||
                            " The place is close to Barceloneta Beach and bus stop just 2 min by walk and near to &quot;Naviglio&quot;  where you can enjoy the main night life in Barcelona."
                    }
                </p>
            </div>

            <div class="flex items-center p-4">
                <Image
                    width={100}
                    height={100}
                    loading={lazyAceppt}
                    alt={firstName || "Tania Andrew"}
                    src={imageUser || import.meta.env.SECRET_IMG_DEFAULT}
                    class="relative inline-block w-8 h-8 rounded-full"
                />
                <p class="flex flex-col ml-3 text-sm">
                    <span class="font-semibold text-slate-100"
                        >{firstName || "Lewis Daniel"}</span
                    >
                    <span class="text-slate-300">
                        {
                            new Date(inscripcionDate).toLocaleDateString(
                                language,
                            ) || "January 10, 2024"
                        }
                    </span>
                </p>
            </div>
        </div>
    </a>
</article>
