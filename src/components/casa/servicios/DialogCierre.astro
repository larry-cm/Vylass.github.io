<script>
    function setupDialog() {
        const openDialog = Array.from(document.querySelectorAll(".openDialog"));
        const dialog = document.querySelector(
            ".favDialog",
        ) as HTMLDialogElement;

        openDialog.forEach((e) => {
            e?.addEventListener("click", function (e: Event) {
                if (dialog && typeof dialog.showModal === "function") {
                    dialog.showModal();
                }
            });
        });
    }

    setupDialog();
</script>

<script>
    function setupLogout() {
        async function signOut() {
            await fetch("/api/verifyUsers/logout");
            window.location.href = "/";

            document
                .querySelector(".cerrar-session")
                ?.removeEventListener("click", signOut);
        }
        document
            .querySelector(".cerrar-session")
            ?.addEventListener("click", signOut, { once: true });
    }
    setupLogout();
</script>

<dialog
    closedby="any"
    class="favDialog left-0 right-0 top-0 bottom-0 m-auto fixed rounded transition-all bg-white dark:bg-[#1a1a1a] border border-slate-200"
>
    <form method="dialog" class="p-4">
        <h2
            class="mb-4 text-lg font-semibold text-slate-900 dark:text-slate-100"
        >
            Cerrar sesión
        </h2>
        <p class="mb-4 text-slate-700 dark:text-slate-300">
            ¿Estás seguro de que deseas cerrar sesión?
        </p>
        <menu class="flex justify-between *:cursor-pointer">
            <button
                type="submit"
                class="px-4 py-2 mr-2 rounded bg-black/90 hover:bg-black/80 dark:bg-black/50 dark:hover:bg-black/40 text-slate-200 dark:text-slate-100"
            >
                Cancelar
            </button>
            <button
                type="submit"
                class="px-4 py-2 text-white bg-red-600 rounded cerrar-session hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800"
            >
                Cerrar sesión
            </button>
        </menu>
    </form>
</dialog>
